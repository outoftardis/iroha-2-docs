import{_ as e,c as o,o as t,d as a}from"./app.ced819ec.js";const f='{"title":"Peer Configuration","description":"","frontmatter":{},"headers":[{"level":2,"title":"Trusted peers","slug":"trusted-peers"},{"level":2,"title":"Kura","slug":"kura"},{"level":2,"title":"Iroha public addresses","slug":"iroha-public-addresses"},{"level":2,"title":"Logger","slug":"logger"}],"relativePath":"guide/appendix/peer-configuration.md","lastUpdated":1649230251000}',i={},r=a('<h1 id="peer-configuration" tabindex="-1">Peer Configuration <a class="header-anchor" href="#peer-configuration" aria-hidden="true">#</a></h1><p>The peer configuration JSON <code>/configs/peer/config.json</code> is the file that determines how your blockchain operates: we won&#39;t look at it now, but really the only things that you need to worry about are the <code>TRUSTED_PEERS</code> , the <code>KURA</code> <code>BLOCK_STORE_PATH</code> and the <code>TORII</code> <code>P2P_ADDR</code> and <code>API_ADDR</code>. The <code>PUBLIC_KEY</code> and <code>PRIVATE_KEY</code> options will be covered at a later stage. The remaining options are for tuning Iroha, so you don&#39;t want to touch them unless you know what you&#39;re doing.</p><h2 id="trusted-peers" tabindex="-1">Trusted peers <a class="header-anchor" href="#trusted-peers" aria-hidden="true">#</a></h2><p>Iroha is a blockchain ledger. In order for it to work optimally and be Byzantine-fault tolerant with the maximum number of faults allowed, it needs to be started with a set number of peers: 4, 7, 10 \u2026 3f+1, where f is the number of faults. So usually, when you want to start an Iroha deployment you should already know a number of peers that you can trust and join their blockchain. The way it works in the examples, is that you just specify in four<code>config.json</code> files four peers with their public keys and API addresses. Since Iroha has no automatic peer discovery, the only other way to make peers known to each other is to use the <code>iroha_client_cli</code> to register new peers. This is not too difficult with the provided client libraries. In fact using Python\u2019s beautiful soup, the curated list of peers can be updated, registered and un-registered on its own.</p><h2 id="kura" tabindex="-1">Kura <a class="header-anchor" href="#kura" aria-hidden="true">#</a></h2><p>Kura is the \u201Cwarehouse\u201D engine of Iroha; it can store blocks in custom locations, if for some reason <code>./blocks</code> is not available or desirable. There are plans to make the Iroha\u2019s storage tiered: when you reach a certain number of blocks, they get moved elsewhere. The <code>KURA</code> init mode at present does nothing. In the future, it will affect whether or not your block storage does a <code>strict</code> initialisation: checks everything, or a <code>fast</code> one, where everything is \u201Cprobably alright\u2122\u201D.</p><h2 id="iroha-public-addresses" tabindex="-1">Iroha public addresses <a class="header-anchor" href="#iroha-public-addresses" aria-hidden="true">#</a></h2><p><code>TORII</code> the gatekeeper is the module in charge of handling in-coming and out-going connnections. The <code>API_URL</code> is the location to which the client(s) make their requests. You can use it to change some peer-specific configuration options too. While we could give you the examples here, the only up-to-date description can be found in the Iroha\u2019s immediate <a href="https://github.com/hyperledger/iroha/blob/iroha2-dev/docs/source/references/api_spec.md" target="_blank" rel="noopener noreferrer">documentation on GitHub</a>. Most of the time, the only reason to change the <code>API_URL</code> is to change the port, in case <code>8080</code> is either closed, or if you want to randomise ports to avoid certain kinds of attacks. The <code>P2P_ADDR</code> is the internal address used for communication between peers. Take note of <strong>this address</strong> for inclusion in the <code>TRUSTED_PEERS</code> section of the configuration file. Lastly, (and not in the example configuration) you have the prometheus endpoint address. It\u2019s set by adding a value <code>&quot;TELEMETRY_URL&quot;: &quot;127.0.0.1:8180&quot;</code>, to the <code>TORII</code> section. It\u2019s not meant to be human-readable, but a <code>GET</code> request to the <code>127.0.0.1:8180/status</code> will give you a JSON-encoded representation of the top-level metrics, while a <code>GET</code> request to <code>127.0.0.1:8180/metrics</code> will give you a (somewhat verbose) list of all available metrics gathered in Iroha. You might want to change this, if you\u2019re having trouble gathering metrics using <code>prometheus</code>.</p><h2 id="logger" tabindex="-1">Logger <a class="header-anchor" href="#logger" aria-hidden="true">#</a></h2><p>This is possibly the easiest to understand. <code>&quot;MAX_LOG_LEVEL&quot;: &quot;WARN&quot;</code>, changes the logging level to <code>WARN</code>. This means that you don\u2019t get any messages, unless they\u2019re either a warning or an error message. The available options are <code>TRACE</code> (every time you enter a function), <code>DEBUG</code> information that we use when we know something went wrong, <code>INFO</code> the default, <code>WARN</code> and <code>ERROR</code>, which silences any logging except for error messages.</p><p>Another useful option is <code>&quot;LOG_FILE_PATH&quot;: bunyan.json</code> . It creates (if it didn\u2019t exist already) a file called <code>bunyan.json</code> that contains the message log but in a structured format. This is extremely useful for two reasons: first, you can use the <code>bunyan</code> log viewer to filter information more precisely than Iroha would allow you to do. <em>Want only messages from a specific module or package? You can do that with bunyan</em>. Secondly, while copying logs is not too big of a problem if your instance is just a small setup, for bigger and longer running the process the larger the log will be. Having it be saved to a file makes much more sense in that case.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>you can also set this to <code>/dev/stdout</code> if you want to use bunyan\u2019s logging facilities directly, but don\u2019t want to waste space in the filesystem).</p></div>',12),n=[r];function s(d,c,h,l,u,g){return t(),o("div",null,n)}var m=e(i,[["render",s]]);export{f as __pageData,m as default};
